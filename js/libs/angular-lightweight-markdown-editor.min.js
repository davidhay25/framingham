angular.module("angular-lightweight-markdown-editor-templates",[]).run(["$templateCache",function(t){t.put("angular-lightweight-markdown-template.html",'<div class="markdown-editor"><ul class="markdown-editor__actions"><li ng-repeat="control in markdownEditorCtrl.options.controls track by $index" ng-click="markdownEditorCtrl.action(control)" ng-class="{separator: control == \'separator\'}" ng-if="control != \'preview\'"><i ng-if="control != \'separator\'" class="{{markdownEditorCtrl.icons[control]}}"></i></li><li ng-if="markdownEditorCtrl.options.controls.indexOf(\'preview\') > -1" ng-click="markdownEditorCtrl.preview = !markdownEditorCtrl.preview" ng-show="markdownEditorCtrl.showdownEnabled" ng-class="{enabled: markdownEditorCtrl.preview}" class="preview">{{markdownEditorCtrl.translations.textPreview}}</li></ul><div class="markdown-editor__editorarea"><div ng-class="{nopreview: !markdownEditorCtrl.preview}"><textarea ng-model="markdownEditorCtrl.ngModel"></textarea></div><div class="markdown-editor__editorarea__preview" ng-if="markdownEditorCtrl.showdownEnabled" ng-show="markdownEditorCtrl.preview" ng-bind-html="markdownEditorCtrl.getHTML()"></div></div></div>')}]),function(){function t(){return{restrict:"E",templateUrl:"angular-lightweight-markdown-template.html",controller:e,controllerAs:"markdownEditorCtrl",scope:!0,bindToController:{ngModel:"=",textPreview:"@",textProvideText:"@",textProvideLink:"@",showPreview:"=",options:"="},require:["^form","ngModel"],link:function(t,e,n,i){r=e.find("textarea")[0];var o=(i[0],["name","required","minLength","maxLength","placeholder","selectionDirection","selectionStart","selectionEnd","spellcheck"]);angular.forEach(o,function(t){n[t]&&(r[t]=n[t])})}}}function e(t){this.preview=!1,"undefined"!=typeof this.showPreview&&(this.preview=this.showPreview),this.showdownEnabled="undefined"!=typeof showdown;for(var e in o)angular.isDefined(this[e])&&(o[e]=this[e]);this.translations=o,this.action=function(t){var e=d[t](this.ngModel,n());e!==!1&&(this.ngModel=e)},this.getHTML=function(){return this.showdownEnabled?t.trustAsHtml(a.makeHtml(this.ngModel)):""},this.options=angular.extend({},s,this.options),this.icons=u}function n(){return{start:r.selectionStart,end:r.selectionEnd,length:r.selectionEnd-r.selectionStart}}e.$inject=["$sce"],angular.module("angular-lightweight-markdown-editor",["ngSanitize","angular-lightweight-markdown-editor-templates"]).directive("markdownEditor",t);var r,o={textPreview:"Preview",textProvideText:"Please provide link text",textProvideLink:"Please provide link URL"};if("undefined"!=typeof showdown)var a=new showdown.Converter;var s={controls:["bold","italic","strikethrough","separator","heading","heading2","heading3","bullets","numbers","indent","code","separator","link","quote","separator","preview"]},d={bold:function(t,e){return 0==e.length?t:l.surround(t,e.start,e.end-e.start,"**","**")},italic:function(t,e){return 0==e.length?t:l.surround(t,e.start,e.end-e.start,"*","*")},bullets:function(t,e){return l.startLinesWith(t,e.start,e.end,"* ")},numbers:function(t,e){return l.startLinesWith(t,e.start,e.end,"1. ")},heading:function(t,e){return l.startLinesWith(t,e.start,e.end,"#")},heading2:function(t,e){return l.startLinesWith(t,e.start,e.end,"##")},heading3:function(t,e){return l.startLinesWith(t,e.start,e.end,"###")},strikethrough:function(t,e){return 0==e.length?t:l.surround(t,e.start,e.end-e.start,"--","--")},indent:function(t,e){return l.startLinesWith(t,e.start,e.end,"\t")},quote:function(t,e){return l.startLinesWith(t,e.start,e.end,"> ")},code:function(t,e){if(0==e.length)return t;var n=t.substr(0,e.start).lastIndexOf("\n")+1,r=t.substr(e.end).indexOf("\n");if(r==-1)var i=t.length;else var i=e.end+r+1;return[t.substr(0,n),"```\n",t.substr(n,i-n),"\n```\n",t.substr(i)].join("")},link:function(t,e){if(e.length>0)var n=t.substr(e.start,e.length);else{var n=prompt(o.textProvideText);if(!n)return!1}var r=prompt(o.textProvideLink);return!!r&&[t.substr(0,e.start),"["+n+"]","("+r+")",t.substr(e.end)].join("")}},l={surround:function(t,e,n,r,i){var o=t.substr(e,n);return[t.substr(0,e),r?r:"",o,i?i:"",t.substr(e+n)].join("")},startLinesWith:function(t,e,n,r){var i=l.indexes(t.substr(e,n-e),"\n",e),o=t.substr(0,e).lastIndexOf("\n")+1;t=[t.substr(0,o),r,t.substr(o)].join("");for(var a=0;a<i.length;a++)t=[t.substr(0,r.length*(a+1)+i[a]+1),r,t.substr(r.length*(a+1)+i[a]+1)].join("");return t},indexes:function(t,e,n){var r=[];for(i=0;i<t.length;++i)t.substring(i,i+e.length)==e&&r.push(i+n);return r}},u={bold:"ame-bold",italic:"ame-italic",strikethrough:"ame-strikethrough",heading:"ame-header",heading2:"ame-header",heading3:"ame-header",bullets:"ame-list-ul",numbers:"ame-list-ol",indent:"ame-indent",code:"ame-code",link:"ame-link",quote:"ame-quote-right"}}();